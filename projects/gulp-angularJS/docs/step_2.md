Before going on to Step 2, be sure you found a solution to
last week's homework, which was to fix the paths in your
`index.html` generated by `gulp-inject`!

My recommended solution is to remove the leading `/src` from
the paths injected into the `index.html` file, so that we know
that when we build our `/dist`, the built `index.html` won't
depend on our `/src`.  Therefore, we want paths like this:

```html
 <link rel="stylesheet" href="/components/hello-world/hello.css">
```

To do that, I recommend adding `cwd` to the config object we
passed to `gulp-inject` in our `index` task.  It will look
something like this:

```JavaScript
gulp.task('index', () => {
  let target = gulp.src('index');
  let sources = gulp.src([
    '/path/to/*.js',
    '/path/to/*.css'
  ], {
    read: false,
    cwd: __dirname + '/src'
  })
  return target
          // it is the job of `gulp-inject` to fix the problem
          // of writing the correct path in our index.html file.
          // so we will tell it to inject the sources, but ignore
          // the leading /src path
          .pipe(inject(sources, { ignorePath: 'src' }))
          .pipe(gulp.dest('./src'));
});
```
There are a handful of ways to do this, however, and we may find
later that this is not the best solution, depending on how we
build the `/dist`.  [This is a good writeup](https://github.com/klei/gulp-inject/wiki/Clarifying-injected-paths) of a few more options & may be useful later.

One more suggestion!  Update your `serve:src` task with the
following

```JavaScript
gulp.task('serve:src', ['index'], () => { /* do work */  });
```
Whenever we run `gulp`, we always want to rebuild our index
before serving.  Otherwise we need to manually run `gulp index`
before each serve or our code will not change (and that can be
frustrating).

# Step 2: Adding Our Front End Framework

In this application, we will be using AngularJS.  The principles
here should work for any framework desired, however.  That said,
some frameworks, such as React, tend towards other tools like
`webpack` over `gulp`, so there may be some obstacles to overcome.
We will cover this in a future project.

## Standardize Running the App

Before we jump into injecting dependencies, however, lets make
sure that our app is easy to run for anyone.  We don't want
to require knowledge of `gulp` vs `grunt` vs `webpack`, etc etc.
So lets add a script block to our `package.json` and provide
a serve command:

```JavaScript
// package.json
"scripts": {
  "serve" : "gulp"  
}
```

Now, to run the app, someone can:

```bash
npm run serve
```

We can add additional commands here as we extend our app.

## Clean Up Dependencies

I noticed my `package.json` was a little messy, the `dependencies`
and `devDependencies` are mixed.  So lets fix that and organize
both blocks.

```JavaScript
// package.json
// remember! this is JSON, so its a bit fussy about
// double quotes and things.
"dependencies" : {
  // only for code that goes to the browser
  // you may NOT want the versions to have
  // the leading caret:
  // "lodash" : "^4.17.4"
  // vs
  // "lodash" : "4.17.4"
},
"devDependencies": {
  // for servers & builders and things that
  // don't go to the browser.
  // The leading caret is probably fine here!
  // "gulp": "^3.9.1",
}

```

Make sure your reorganization works by running:

```bash
yarn install
```

So long as yarn doesn't complain, you should be in good shape.

### Adding Dependencies

We already used `yarn` to install `angular` and `todomvc-app-css`,
but lets add `lodash` as well, since its such a useful tool.

```bash
yarn add lodash
```

Now, we need to get our new dependencies into our `index.html`.
These will have to work a little differently than our app `/src`
files, since we don't want to just include everyting from our
`node_modules` folder.  Fortunately, `gulp-inject` gives us some
tools for this.

Initially, we can just name our dependencies and do a separate
`vendor` inject block. If our dependency list grows, we may
eventually find this cumbersome.  For now, we only have a few,
so it should be fine.  

Lets rename our `index` task, and add a `vendor` task:

```JavaScript
gulp.task('inject:vendor', () => { });
// this was our previous 'index' task
gulp.task('inject:app', () => {});
```

We will more or less duplicate our `inject:app` (previously
 `index`) task and update the `gulp.src()` list to grab
 `angular`, `lodash`, and `todomvc-app-css` from `node_modules`.

```JavaScript
gulp.task('inject:vendor', () => {
  // update the sources block
  let sources = gulp.src(
    // our vendor files from node_modules
    [
      './node_modules/lodash/lodash.js',
      './node_modules/angular/angular.js',
      './node_modules/todomvc-app-css/index.css'
    ], {
      read: false
    }
  );
  // rest of task omitted......
});
```

And lets add these to a new named injection point in our
`index.html` by updating the `return` in our `inject:vendor`
task

```JavaScript
gulp.task('inject:vendor', () => {
  // task above omitted......
  return target
          .pipe(inject(sources, {
            name: 'vendor'
          }))
          .pipe(gulp.dest('./src'))
});
```

And then we can run `gulp inject:vendor` on the command line and
see if anything happens.  What you will likely see is the following:

```bash
gulp inject:vendor
[11:40:45] Using gulpfile ~/gulp-angularJS/gulpfile.js
[11:40:45] Starting 'inject:vendor'...
## OH NOES!!!!
## Why can't it find our files?
[11:40:45] gulp-inject Nothing to inject into index.html.
[11:40:45] Finished 'inject:vendor' after 45 ms
```

Your `index.html` file should look something like this if it has
all of the injection points for our `vendor` JS & CSS and our
`app` JS & CSS:

```html
<!DOCTYPE html>
<html ng-app="todoApp">
  <head>
    <meta charset="utf-8">
    <title>Hello World</title>

    <!-- vendor:css -->
    <!-- endinject -->

    <!-- app:css -->
    <!-- endinject -->
  </head>
  <body>
    <h1>Hello World</h1>

    <div class="hello">Hello?</div>

    <!-- vendor:js -->
    <!-- endinject -->

    <!-- app:js -->
    <!-- endinject -->
  </body>
</html>
```

The assignment for next week is to again solve the `src` problem
and figure out how to get `gulp-inject` to find the files and
correctly insert them into the index.html page.  The best starting
point is going to be the [gulp-inject npmjs](https://www.npmjs.com/package/gulp-inject#injecting-dist-files-into-bowerjsons-main-section) page itself.  There are quite
a few options detailed for how to fix this problem.

Next week we should (finally) be able to start putting together
our actual app!

## Homework

1.  As stated above, fix the `gulp-inject` vendor block to
    find angular, lodash, and our css & inject them into the
    html file. Be sure to run `gulp serve` and see if the files
    load in the browser!
1.  You will probably notice that our `index.html` file is correct,
    but we are not actually serving any of our vendor files form the
    `node_modules` folder!  Our app will not work if the browser cannot
    receive these files.  Update our `serve:src` task to serve
    these files to the browser.
1.  Update our `serve:src` task to automatically run both
    `inject:vendor` and `inject:app` so that we automatically
    rebuild the application whenever we serve it.
1.  Clean up the `gulpfile.js` file.  If there is any duplication,
    use some variables to remove it.  For example, the PATHS
    can easily be factored out.  Its possible to share the
    `target` index.html file as well, and maybe some other paths.
    Keep it DRY.
1.  If you get this far, see if you can get `browserSync` to
    live-reload whenver any of our `./src` app files change. This
    is also well-documented.
